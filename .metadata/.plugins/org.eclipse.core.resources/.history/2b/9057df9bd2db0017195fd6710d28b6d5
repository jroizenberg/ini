<?xml version="1.0" encoding="utf-8"?>
<?page id="selector" title="Cursos"?>

<?taglib uri="http://www.zkoss.org/dsp/web/core" prefix="c" ?>
<zk>

<script type="text/javascript">
var autoimprimir = true;
	var prueba='abcde';

function ImprimirVar(){
		alert("Entro");
		var printing = window.open("","ImprimirVar");
		printing.document.open();
		printing.document.write("sasas");
		printing.document.close();
		printing.print();
}

function imprimeTicket(){
	alert("1");
	var texto="sasasasassss";
	alert("2");
	var objFSO=new ActiveXObject("Scripting.FileSystemObject");
	alert("3");
	var objPrinter = objFSO.OpenTextFile("COM1:", 2,true);
	alert("4");
	objPrinter.WriteLine(texto);
	alert("5");
	objPrinter.Close();
	alert("6");
}
</script>
	<style src="/style/institucion.css"/>
	<window entity="cclaseSelector" apply="com.institucion.controller.ImpresoraSelectorComposer" use="com.institucion.fm.desktop.view.WindowSelector">
		<panel id="toolbar" use="com.institucion.desktop.view.ClaseSelector" tokenPrefix="claseSelector" />
		<panel id="filter" use="com.institucion.fm.desktop.view.PanelFilter" usefilter="com.institucion.model.ImpresoraFilter" />
				
		   <button id="export" label="Click" onClick='Clients.evalJavaScript("ImprimirVar()")'/>
		   <button id="export2" label="Click2" onClick='Clients.evalJavaScript("imprimeTicket()")'/>
	</window>
</zk>